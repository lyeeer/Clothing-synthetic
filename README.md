# Clothing-synthetic
segment the clothes and pants of the images by Grab_cut, and then splice them

### Purpose:
编写一个程序完成将上装图像和下装图像合成到一副图像中，该任务的输入有4张图像：input1.jpg,input2.jpg,input3.jpg,input4.jpg，输出output.jpg。
可以适当增加一些信息作为input, 例如上装所在位置的种子点、下装所在位置的种子点、...

### Analyse:
input3.JPG是input1.JPG扎在裤子里穿效果，也就是目标图像中output.JPG中衣服需要部分被input2.JPG所示的裤子覆盖。但是output.JPG中衣服扎进去手臂中间露出来的缝隙效果并不与input1.JPG与input2.JPG中完全一致，但这里对显示效果影响很小，暂且忽略不计。希望上衣和裤子能够最大程度还原原效果，仍以input1.JPG的上衣（包括手）和input2.JPG的裤子（包括腿）为图片合成的元素。这样就将问题转化为了先对input1.JPG的上衣和input2.JPG的裤子进行图像分割操作，然后对分割的结果以input3.JPG和input4.JPG中的穿着效果（腰线位置，衣服与裤子的覆盖情况）进行合成。

所谓的图像分割指的是根据灰度、颜色、纹理和形状等特征把图像划分为若干不交迭的区域，并使这些特征在同一区域内呈现相似性，而在不同区域间呈现出明显的差异性。

由于这里的背景颜色较为单一，需要进行分割的区域也较为规则和固定，背景与衣服/裤子颜色反差较大，所以我们选用grabcut算法对图像进行分割操作。

### How to run:
执行grab_cut.py文件

在该文件目录下建立命名为img的文件夹，里面存放命名为”1”、”2”、”3”、”4”、”joint_image_0”、”joint_image_1”的四个空文件夹，”1”、”2”、”3”、”4”每个文件夹中预先存放一组需要合成的图片,”joint_image_0”、”joint_image_1”分别用于运行时存储”1”/”2”、”3”\”4”组上下装的切割效果。

执行后生成res_joint_final_1.png~res_joint_final_4.png分别代表四组图片的合成结果。

### Problem:
grab_cut切割出来的图片转化为矩阵形式时，就会自带后面的背景。这样合成就相当于单纯叠加再把边缘去除......why？是grab_cut自带的属性吗?

### 附：GrabCut算法的实现步骤为：

1）在图片中定义含有（一个或多个）物体的矩形；

2）矩形外的区域被自动认为是背景；

3）对于用户定义的矩形区域，可用背景中的数据来区分它里面的前景和背景区域；

4）用高斯混合模型（GMM）来对背景和前景建模，并将未定义的像素标记为可能的前景或背景；

5）图像中的每一个像素都被看作通过虚拟边与周围像素相连接，而每条边都有一个属于前景或背景的概率，这基于它与周围像素颜色上的相似性；

6）每一个像素会与一个前景或背景节点连接；

7）在节点完成连接后，若节点之间的边属于不同终端，则会切断它们之间的边，从而将图像各部分分割出来。

